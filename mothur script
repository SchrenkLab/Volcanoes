#mothur SOP from P. Schloss
#H Miller
#2017.11.27

#QC fastq files FIRST


#from within HPCC after accessing a development node
[mill2735@dev-intel16-k80 ~]$ module load mothur

#RESPONSE: This is the multi-threaded non-MPI version of Mothur. See: https://wiki.hpcc.msu.edu/display/Bioinfo/Mothur+-+MPI+versus+Non-MPI+Versions

[mill2735@dev-intel16-k80 ~]$ mothur

mothur > make.file(inputdir=MiSeq_SOP, type=fastq, prefix=stability)
mothur > make.contigs(file=stability.files, processors=8)
mothur > summary.seqs(fasta=stability.trim.contigs.fasta)
mothur > screen.seqs(fasta=stability.trim.contigs.fasta, group=stability.contigs.groups, maxambig=0, maxlength=275)
mothur > screen.seqs(fasta=stability.trim.contigs.fasta, group=stability.contigs.groups, summary=stability.trim.contigs.summary, maxambig=0, maxlength=275)
mothur > get.current()
mothur > summary.seqs(fasta=stability.trim.contigs.good.fasta)
mothur > summary.seqs(fasta=current)
mothur > summary.seqs()
mothur > unique.seqs(fasta=stability.trim.contigs.good.fasta)
mothur > count.seqs(name=stability.trim.contigs.good.names, group=stability.contigs.good.groups)
mothur > summary.seqs(count=stability.trim.contigs.good.count_table)
mothur > pcr.seqs(fasta=silva.bacteria.fasta, start=11894, end=25319, keepdots=F, processors=8)
mothur > rename.file(input=silva.bacteria.pcr.fasta, new=silva.v4.fasta)
mothur > summary.seqs(fasta=silva.v4.fasta)
mothur > align.seqs(fasta=stability.trim.contigs.good.unique.fasta, reference=silva.v4.fasta)
mothur > summary.seqs(fasta=stability.trim.contigs.good.unique.align, count=stability.trim.contigs.good.count_table)






